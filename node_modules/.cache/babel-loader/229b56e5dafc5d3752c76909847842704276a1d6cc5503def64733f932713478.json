{"ast":null,"code":"import * as d3 from 'd3';\nexport function createBarChart(data) {\n  // Parser per le date\n  var parseDate = d3.timeParse('%Y-%m-%dT%H:%M:%S%Z');\n\n  // Calcola la differenza di tempo in millisecondi\n  data.forEach(function (d) {\n    d.travelStartTime = parseDate(d.travelStartTime);\n    d.travelEndTime = parseDate(d.travelEndTime);\n    d.travelDuration = d.travelEndTime - d.travelStartTime;\n  });\n\n  // Dimensioni del grafico\n  var width = 500;\n  var height = 300;\n  var margin = {\n    top: 20,\n    right: 20,\n    bottom: 30,\n    left: 40\n  };\n  var chartWidth = width - margin.left - margin.right;\n  var chartHeight = height - margin.top - margin.bottom;\n\n  // Rimuovi grafico esistente, se presente\n  d3.select('#chart').selectAll('*').remove();\n\n  // Creazione del grafico a barre\n  var svg = d3.select('#chart').attr('width', width).attr('height', height);\n  var chart = svg.append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n  // Funzione per aggiornare il grafico\n  function updateChart(week) {\n    var filteredData = data.filter(function (d) {\n      var weekStart = new Date('2022-03-01');\n      weekStart.setDate(weekStart.getDate() + week * 7);\n      var weekEnd = new Date(weekStart);\n      weekEnd.setDate(weekEnd.getDate() + 7);\n      return d.travelStartTime >= weekStart && d.travelStartTime < weekEnd;\n    });\n    var dayOfWeek = d3.timeFormat('%A');\n    var sumByDay = d3.rollup(filteredData, function (v) {\n      return d3.sum(v, function (d) {\n        return d.travelDuration;\n      });\n    }, function (d) {\n      return dayOfWeek(d.travelStartTime);\n    });\n    var x = d3.scaleBand().domain(['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']).range([0, chartWidth]).padding(0.1);\n    var y = d3.scaleLinear().domain([0, d3.max(Array.from(sumByDay.values()))]).range([chartHeight, 0]);\n    var bars = chart.selectAll('.bar').data(Array.from(sumByDay.entries()), function (d) {\n      return d[0];\n    });\n    bars.enter().append('rect').attr('class', 'bar').merge(bars).attr('x', function (d) {\n      return x(d[0]);\n    }).attr('y', function (d) {\n      return y(d[1]);\n    }).attr('width', x.bandwidth()).attr('height', function (d) {\n      return chartHeight - y(d[1]);\n    });\n    bars.exit().remove();\n  }\n\n  // Inizializza il grafico\n  updateChart(0);\n}","map":{"version":3,"names":["d3","createBarChart","data","parseDate","timeParse","forEach","d","travelStartTime","travelEndTime","travelDuration","width","height","margin","top","right","bottom","left","chartWidth","chartHeight","select","selectAll","remove","svg","attr","chart","append","updateChart","week","filteredData","filter","weekStart","Date","setDate","getDate","weekEnd","dayOfWeek","timeFormat","sumByDay","rollup","v","sum","x","scaleBand","domain","range","padding","y","scaleLinear","max","Array","from","values","bars","entries","enter","merge","bandwidth","exit"],"sources":["/Users/camillachiruzzi/vastprof/VAST2022Vue/src/assets/TrafficPlot.js"],"sourcesContent":["import * as d3 from 'd3';\n\nexport function createBarChart(data) {\n  // Parser per le date\n  var parseDate = d3.timeParse('%Y-%m-%dT%H:%M:%S%Z');\n\n  // Calcola la differenza di tempo in millisecondi\n  data.forEach(function(d) {\n    d.travelStartTime = parseDate(d.travelStartTime);\n    d.travelEndTime = parseDate(d.travelEndTime);\n    d.travelDuration = d.travelEndTime - d.travelStartTime;\n  });\n\n  // Dimensioni del grafico\n  var width = 500;\n  var height = 300;\n  var margin = { top: 20, right: 20, bottom: 30, left: 40 };\n  var chartWidth = width - margin.left - margin.right;\n  var chartHeight = height - margin.top - margin.bottom;\n\n  // Rimuovi grafico esistente, se presente\n  d3.select('#chart').selectAll('*').remove();\n\n  // Creazione del grafico a barre\n  var svg = d3.select('#chart')\n    .attr('width', width)\n    .attr('height', height);\n\n  var chart = svg.append('g')\n    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n  // Funzione per aggiornare il grafico\n  function updateChart(week) {\n    var filteredData = data.filter(function(d) {\n      var weekStart = new Date('2022-03-01');\n      weekStart.setDate(weekStart.getDate() + week * 7);\n      var weekEnd = new Date(weekStart);\n      weekEnd.setDate(weekEnd.getDate() + 7);\n      return d.travelStartTime >= weekStart && d.travelStartTime < weekEnd;\n    });\n\n    var dayOfWeek = d3.timeFormat('%A');\n    var sumByDay = d3.rollup(filteredData, function(v) {\n      return d3.sum(v, function(d) {\n        return d.travelDuration;\n      });\n    }, function(d) {\n      return dayOfWeek(d.travelStartTime);\n    });\n\n    var x = d3.scaleBand()\n      .domain(['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'])\n      .range([0, chartWidth])\n      .padding(0.1);\n\n    var y = d3.scaleLinear()\n      .domain([0, d3.max(Array.from(sumByDay.values()))])\n      .range([chartHeight, 0]);\n\n    var bars = chart.selectAll('.bar')\n      .data(Array.from(sumByDay.entries()), function(d) { return d[0]; });\n\n    bars.enter().append('rect')\n      .attr('class', 'bar')\n      .merge(bars)\n      .attr('x', function(d) { return x(d[0]); })\n      .attr('y', function(d) { return y(d[1]); })\n      .attr('width', x.bandwidth())\n      .attr('height', function(d) { return chartHeight - y(d[1]); });\n\n    bars.exit().remove();\n  }\n\n  // Inizializza il grafico\n  updateChart(0);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}