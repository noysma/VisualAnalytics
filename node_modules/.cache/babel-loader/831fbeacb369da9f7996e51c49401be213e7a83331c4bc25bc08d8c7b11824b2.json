{"ast":null,"code":"import * as d3 from \"d3\";\nexport function createBarChart(data) {\n  // Raggruppa i dati per categoria e calcola la somma degli importi per ogni categoria\n  const aggregatedData = d3.rollup(data, group => d3.sum(group, d => d.properties.amount), d => d.properties.category);\n\n  // Converte i dati aggregati in un array di oggetti\n  const aggregatedArray = Array.from(aggregatedData, ([category, amount]) => ({\n    category,\n    amount\n  }));\n\n  // Crea la larghezza e l'altezza del grafico\n  const width = 600;\n  const height = 400;\n  const margin = {\n    top: 20,\n    right: 20,\n    bottom: 50,\n    left: 50\n  };\n\n  // Calcola il valore minimo per l'asse y considerando anche i valori negativi\n  const minValue = Math.min(d3.min(aggregatedArray, d => d.amount), 0);\n\n  // Crea la scala dell'altezza\n  const yScale = d3.scaleLinear().domain([minValue, d3.max(aggregatedArray, d => d.amount)]).range([height - margin.bottom, margin.top]).nice();\n\n  // Crea la scala dell'asse x utilizzando le categorie\n  const xScale = d3.scaleBand().domain(aggregatedArray.map(d => d.category)).range([0, width]).padding(0.1);\n\n  // Crea l'asse delle y\n  const yAxis = d3.axisLeft(yScale);\n\n  // Crea l'asse delle x\n  const xAxis = d3.axisBottom(xScale);\n\n  // Crea l'elemento SVG per il bar chart con spazio aggiuntivo per gli assi\n  const svg = d3.select(\"#bar-chart\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n  // Crea i rettangoli per le barre\n  const bars = svg.selectAll(\".bar\").data(aggregatedArray).enter().append(\"rect\").attr(\"class\", \"bar\").attr(\"x\", d => xScale(d.category)).attr(\"y\", d => d.amount >= 0 ? yScale(d.amount) : yScale(0)).attr(\"width\", xScale.bandwidth()).style(\"stroke\", \"black\").attr(\"height\", d => Math.abs(yScale(d.amount) - yScale(0))).attr(\"fill\", d => d.amount >= 0 ? \"steelblue\" : \"red\");\n\n  // Aggiungi l'asse delle y al bar chart\n  svg.append(\"g\").call(yAxis);\n\n  // Aggiungi l'asse delle x al bar chart\n  svg.append(\"g\").attr(\"transform\", `translate(0, ${yScale(0)})`).call(xAxis).selectAll(\".tick text\").remove();\n  const categoryLabels = svg.append(\"g\").attr(\"class\", \"category-labels\").attr(\"transform\", `translate(0, ${height - margin.bottom + 10})`); // Aggiusta la posizione delle etichette\n\n  categoryLabels.selectAll(\".category-label\").data(aggregatedArray).enter().append(\"text\").attr(\"class\", \"category-label\").attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2).attr(\"y\", 0).attr(\"text-anchor\", \"middle\").style(\"font-weight\", \"bold\").style(\"font-size\", \"12px\").text(d => d.category);\n\n  // Aggiungi etichette per le barre\n  svg.selectAll(\".label\").data(aggregatedArray).enter().append(\"text\").attr(\"class\", \"label\").attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2).attr(\"y\", d => d.amount >= 0 ? yScale(0) - 5 : yScale(0) + 15).attr(\"text-anchor\", \"middle\").style(\"font-weight\", \"bold\").style(\"font-size\", \"12px\").text(d => d3.format(\".2f\")(d.amount));\n  svg.selectAll(\".label\").data(aggregatedArray).enter().append(\"text\").attr(\"class\", \"label\").attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2).attr(\"y\", d => d.amount >= 0 ? yScale(d.amount) - 15 : yScale(d.amount) + 15).attr(\"text-anchor\", \"middle\").text(d => d3.format(d.category));\n  return bars;\n}","map":{"version":3,"names":["d3","createBarChart","data","aggregatedData","rollup","group","sum","d","properties","amount","category","aggregatedArray","Array","from","width","height","margin","top","right","bottom","left","minValue","Math","min","yScale","scaleLinear","domain","max","range","nice","xScale","scaleBand","map","padding","yAxis","axisLeft","xAxis","axisBottom","svg","select","append","attr","bars","selectAll","enter","bandwidth","style","abs","call","remove","categoryLabels","text","format"],"sources":["/Users/camillachiruzzi/vastprof/VAST2022Vue/src/assets/CitizenPurchase.js"],"sourcesContent":["import * as d3 from \"d3\";\n\nexport function createBarChart(data) {\n  // Raggruppa i dati per categoria e calcola la somma degli importi per ogni categoria\n  const aggregatedData = d3.rollup(\n    data,\n    group => d3.sum(group, d => d.properties.amount),\n    d => d.properties.category\n  );\n\n  // Converte i dati aggregati in un array di oggetti\n  const aggregatedArray = Array.from(aggregatedData, ([category, amount]) => ({\n    category,\n    amount\n  }));\n\n  // Crea la larghezza e l'altezza del grafico\n  const width = 600;\n  const height = 400;\n  const margin = { top: 20, right: 20, bottom: 50, left: 50 };\n\n  // Calcola il valore minimo per l'asse y considerando anche i valori negativi\n  const minValue = Math.min(d3.min(aggregatedArray, d => d.amount), 0);\n\n  // Crea la scala dell'altezza\n  const yScale = d3.scaleLinear()\n    .domain([minValue, d3.max(aggregatedArray, d => d.amount)])\n    .range([height - margin.bottom, margin.top])\n    .nice();\n\n  // Crea la scala dell'asse x utilizzando le categorie\n  const xScale = d3.scaleBand()\n    .domain(aggregatedArray.map(d => d.category))\n    .range([0, width])\n    .padding(0.1);\n\n  // Crea l'asse delle y\n  const yAxis = d3.axisLeft(yScale);\n\n  // Crea l'asse delle x\n  const xAxis = d3.axisBottom(xScale);\n\n  // Crea l'elemento SVG per il bar chart con spazio aggiuntivo per gli assi\n  const svg = d3.select(\"#bar-chart\")\n    .append(\"svg\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom)\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n  // Crea i rettangoli per le barre\n  const bars = svg.selectAll(\".bar\")\n    .data(aggregatedArray)\n    .enter()\n    .append(\"rect\")\n    .attr(\"class\", \"bar\")\n    .attr(\"x\", d => xScale(d.category))\n    .attr(\"y\", d => (d.amount >= 0) ? yScale(d.amount) : yScale(0))\n    .attr(\"width\", xScale.bandwidth())\n    .style(\"stroke\", \"black\")\n    .attr(\"height\", d => Math.abs(yScale(d.amount) - yScale(0)))\n    .attr(\"fill\", d => (d.amount >= 0) ? \"steelblue\" : \"red\");\n\n  // Aggiungi l'asse delle y al bar chart\n  svg.append(\"g\")\n    .call(yAxis);\n\n  // Aggiungi l'asse delle x al bar chart\n  svg.append(\"g\")\n    .attr(\"transform\", `translate(0, ${yScale(0)})`)\n    .call(xAxis)\n    .selectAll(\".tick text\")\n    .remove();\n\n  const categoryLabels = svg.append(\"g\")\n  .attr(\"class\", \"category-labels\")\n  .attr(\"transform\", `translate(0, ${height - margin.bottom + 10})`); // Aggiusta la posizione delle etichette\n  \n  categoryLabels.selectAll(\".category-label\")\n    .data(aggregatedArray)\n    .enter()\n    .append(\"text\")\n    .attr(\"class\", \"category-label\")\n    .attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2)\n    .attr(\"y\", 0)\n    .attr(\"text-anchor\", \"middle\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"font-size\", \"12px\")\n    .text(d => d.category);    \n\n  // Aggiungi etichette per le barre\n  svg.selectAll(\".label\")\n    .data(aggregatedArray)\n    .enter()\n    .append(\"text\")\n    .attr(\"class\", \"label\")\n    .attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2)\n    .attr(\"y\", d => (d.amount >= 0) ? yScale(0) - 5 : yScale(0) + 15)\n    .attr(\"text-anchor\", \"middle\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"font-size\", \"12px\")    \n    .text(d => d3.format(\".2f\")(d.amount));\n  \n  svg.selectAll(\".label\")\n    .data(aggregatedArray)\n    .enter()\n    .append(\"text\")\n    .attr(\"class\", \"label\")\n    .attr(\"x\", d => xScale(d.category) + xScale.bandwidth() / 2)\n    .attr(\"y\", d => (d.amount >= 0) ? yScale(d.amount) - 15 : yScale(d.amount) + 15)\n    .attr(\"text-anchor\", \"middle\")\n    .text(d => d3.format(d.category));\n\n  return bars;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}