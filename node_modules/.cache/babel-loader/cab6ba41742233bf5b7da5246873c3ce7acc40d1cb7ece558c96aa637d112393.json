{"ast":null,"code":"import * as d3 from \"d3\";\nexport function createRoutine(data, container, width, height) {\n  const parseTime = d3.timeParse(\"%Y-%m-%dT%H:%M:%SZ\");\n  const formattedData = data.map(d => {\n    return {\n      participantId: +d.participantId,\n      timestamp: parseTime(d.timestamp),\n      currentMode: d.currentMode\n    };\n  });\n  const groupedData = d3.group(formattedData, d => d3.timeDay.floor(d.timestamp));\n  const modes = Array.from(new Set(formattedData.map(d => d.currentMode)));\n  const colorScale = d3.scaleOrdinal().domain(modes).range(d3.schemeCategory10);\n  const rectWidth = width / (1440 / 5);\n  const rectHeight = height / groupedData.size;\n  const svg = d3.select(container).append(\"svg\").attr(\"width\", width).attr(\"height\", height + 50);\n  const heatmap = svg.selectAll(\"g\").data(Array.from(groupedData)).enter().append(\"g\").attr(\"transform\", (d, i) => `translate(0, ${i * rectHeight + 20})`);\n  heatmap.selectAll(\"rect\").data(d => d[1]).enter().append(\"rect\").attr(\"x\", d => {\n    const dayStart = d3.timeDay.floor(d.timestamp);\n    const minutesSinceStart = d3.timeMinute.count(dayStart, d.timestamp);\n    return minutesSinceStart * rectWidth / 5;\n  }).attr(\"y\", 0).attr(\"width\", rectWidth).attr(\"height\", rectHeight).style(\"fill\", d => colorScale(d.currentMode));\n  const startTime = new Date();\n  startTime.setHours(0, 0, 0, 0);\n  const endTime = new Date();\n  endTime.setHours(24, 0, 0, 0);\n  let xScale = d3.scaleTime().domain([startTime, endTime]).range([15, width - 15]);\n  const xAxisTickFormat = date => {\n    const hours = date.getHours();\n    return hours === 0 ? \"00:00\" : d3.timeFormat(\"%H:%M\")(date);\n  };\n  const xAxis = d3.axisBottom(xScale).ticks(d3.timeHour.every(3)).tickFormat(xAxisTickFormat);\n  const xAxisGroup = svg.append(\"g\").attr(\"class\", \"axis\").attr(\"transform\", `translate(0)`).call(xAxis);\n  xAxisGroup.select(\".domain\").remove();\n  xAxisGroup.selectAll(\".tick line\").remove();\n  xAxisGroup.selectAll(\".tick text\").style(\"font-size\", \"11px\");\n  xAxisGroup.selectAll(\".tick text\").style(\"text-anchor\", \"middle\");\n  const yScale = d3.scaleTime().domain([d3.timeDay.floor(d3.min(formattedData, d => d.timestamp)), d3.timeDay.ceil(d3.max(formattedData, d => d.timestamp))]).range([0, height]);\n  const yAxis = d3.axisLeft(yScale).tickFormat(d3.timeFormat(\"%Y-%m-%d\"));\n  const yAxisGroup = svg.append(\"g\").call(yAxis);\n  yAxisGroup.select(\".domain\").remove();\n  const lineGroup = heatmap.append(\"g\");\n  xScale = d3.scaleTime().domain([startTime, endTime]).range([0, width]);\n  lineGroup.selectAll(\"line\").data(xAxisGroup.selectAll(\".tick\").data()).enter().append(\"line\").attr(\"x1\", d => xScale(d)).attr(\"y1\", 0).attr(\"x2\", d => xScale(d)).attr(\"y2\", rectHeight).attr(\"stroke\", \"black\").attr(\"stroke-width\", 1);\n}","map":{"version":3,"names":["d3","createRoutine","data","container","width","height","parseTime","timeParse","formattedData","map","d","participantId","timestamp","currentMode","groupedData","group","timeDay","floor","modes","Array","from","Set","colorScale","scaleOrdinal","domain","range","schemeCategory10","rectWidth","rectHeight","size","svg","select","append","attr","heatmap","selectAll","enter","i","dayStart","minutesSinceStart","timeMinute","count","style","startTime","Date","setHours","endTime","xScale","scaleTime","xAxisTickFormat","date","hours","getHours","timeFormat","xAxis","axisBottom","ticks","timeHour","every","tickFormat","xAxisGroup","call","remove","yScale","min","ceil","max","yAxis","axisLeft","yAxisGroup","lineGroup"],"sources":["/Users/camillachiruzzi/vastprof/VAST2022Vue/src/assets/RoutineComparison.js"],"sourcesContent":["import * as d3 from \"d3\";\n\nexport function createRoutine(data, container, width, height) {\n  const parseTime = d3.timeParse(\"%Y-%m-%dT%H:%M:%SZ\");\n\n  const formattedData = data.map((d) => {\n    return {\n      participantId: +d.participantId,\n      timestamp: parseTime(d.timestamp),\n      currentMode: d.currentMode,\n    };\n  });\n\n  const groupedData = d3.group(formattedData, (d) => d3.timeDay.floor(d.timestamp));\n\n  const modes = Array.from(new Set(formattedData.map((d) => d.currentMode)));\n\n  const colorScale = d3\n    .scaleOrdinal()\n    .domain(modes)\n    .range(d3.schemeCategory10);\n\n  const rectWidth = width / (1440 / 5); \n  const rectHeight = height / groupedData.size;\n\n  const svg = d3.select(container)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height + 50);\n\n  const heatmap = svg.selectAll(\"g\")\n    .data(Array.from(groupedData))\n    .enter()\n    .append(\"g\")\n    .attr(\"transform\", (d, i) => `translate(0, ${i * rectHeight + 20})`); \n\n  heatmap.selectAll(\"rect\")\n    .data((d) => d[1])\n    .enter()\n    .append(\"rect\")\n    .attr(\"x\", (d) => {\n      const dayStart = d3.timeDay.floor(d.timestamp);\n      const minutesSinceStart = d3.timeMinute.count(dayStart, d.timestamp);\n      return (minutesSinceStart * rectWidth) / 5; \n    })\n    .attr(\"y\", 0)\n    .attr(\"width\", rectWidth)\n    .attr(\"height\", rectHeight)\n    .style(\"fill\", (d) => colorScale(d.currentMode));\n\n  const startTime = new Date();\n  startTime.setHours(0, 0, 0, 0); \n\n  const endTime = new Date();\n  endTime.setHours(24, 0, 0, 0);\n\n  let xScale = d3.scaleTime()\n    .domain([startTime, endTime])\n    .range([15, width-15]);\n  \n    const xAxisTickFormat = (date) => {\n      const hours = date.getHours();\n      return hours === 0 ? \"00:00\" : d3.timeFormat(\"%H:%M\")(date);\n    };  \n\n  const xAxis = d3.axisBottom(xScale)\n    .ticks(d3.timeHour.every(3)) \n    .tickFormat(xAxisTickFormat);\n\n  const xAxisGroup = svg.append(\"g\")\n    .attr(\"class\", \"axis\")\n    .attr(\"transform\", `translate(0)`)\n    .call(xAxis);\n\n  xAxisGroup.select(\".domain\").remove(); \n  xAxisGroup.selectAll(\".tick line\").remove(); \n  xAxisGroup.selectAll(\".tick text\").style(\"font-size\", \"11px\");\n  xAxisGroup.selectAll(\".tick text\").style(\"text-anchor\", \"middle\");\n\n  const yScale = d3.scaleTime()\n    .domain([\n      d3.timeDay.floor(d3.min(formattedData, (d) => d.timestamp)),\n      d3.timeDay.ceil(d3.max(formattedData, (d) => d.timestamp)),\n    ])\n    .range([0, height]);\n\n  const yAxis = d3.axisLeft(yScale)\n    .tickFormat(d3.timeFormat(\"%Y-%m-%d\"));\n  \n  const yAxisGroup = svg.append(\"g\")\n      .call(yAxis);\n    \n  yAxisGroup.select(\".domain\").remove();\n\n  const lineGroup = heatmap.append(\"g\");\n\n  xScale = d3.scaleTime()\n    .domain([startTime, endTime])\n    .range([0, width]);\n\n  lineGroup.selectAll(\"line\")\n    .data(xAxisGroup.selectAll(\".tick\").data())\n    .enter()\n    .append(\"line\")\n    .attr(\"x1\", (d) => xScale(d))\n    .attr(\"y1\", 0)\n    .attr(\"x2\", (d) => xScale(d))\n    .attr(\"y2\", rectHeight)\n    .attr(\"stroke\", \"black\")\n    .attr(\"stroke-width\", 1);\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}