{"ast":null,"code":"import * as d3 from 'd3';\nfunction DensityMap() {\n  const color = density => {\n    const logScale = d3.scaleLog().domain([100, 1]).range([0, 1]);\n    return density ? d3.interpolateRdYlBu(logScale(density)) : \"#f0f0f0\";\n  };\n  const defaultColor = \"#ffffff\"; // White color for non-residential buildings\n  let extent;\n  function me(selection) {\n    const data = selection.datum(); // Get the data from the selection\n\n    const residentialCommercialData = data.filter(d => d.properties.buildingType === \"Residental\" || d.properties.buildingType === \"Commercial\");\n    extent = {\n      type: \"GeometryCollection\",\n      geometries: residentialCommercialData.map(d => d.geometry)\n    };\n    const projection = d3.geoIdentity().reflectY(true).fitSize([650, 650], extent);\n    const path = d3.geoPath().projection(projection);\n    const tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 0);\n    selection.selectAll(\"path\").data(data).join(\"path\").attr(\"d\", path).attr(\"fill\", d => {\n      if (d.properties.buildingType === \"Residental\" || d.properties.buildingType === \"Commercial\") {\n        return color(d.properties.maxOccupancy);\n      } else {\n        return defaultColor;\n      }\n    }).attr(\"stroke\", \"black\").attr(\"stroke-width\", 1).on(\"mouseover\", (event, d) => {\n      const maxOccupancy = d.properties.maxOccupancy;\n      tooltip.style(\"opacity\", 1).html(`Max Occupancy: ${maxOccupancy}`).style(\"left\", event.pageX + \"px\").style(\"top\", event.pageY + \"px\");\n    }).on(\"mouseout\", () => {\n      tooltip.style(\"opacity\", 0);\n    });\n\n    // ADDING THE SCALEBAR\n    const maxOccupancy = d3.max(residentialCommercialData, d => d.properties.maxOccupancy);\n    const colorScale = d3.scaleSequential(d3.interpolateRdYlBu).domain([1, maxOccupancy]);\n    const scaleGroup = selection.append(\"g\").attr(\"transform\", \"translate(10, 620)\");\n    scaleGroup.selectAll(\"rect\").data(colorScale.ticks(10).reverse()).join(\"rect\").attr(\"x\", (d, i) => i * 37).attr(\"y\", 0).attr(\"width\", 37).attr(\"height\", 10).attr(\"fill\", d => colorScale(d));\n    scaleGroup.selectAll(\"text\").data(colorScale.ticks(10)).join(\"text\").attr(\"x\", (d, i) => i * 37).attr(\"y\", 25).attr(\"text-anchor\", \"middle\").text(d => d).style(\"font-weight\", \"bold\").style(\"font-size\", \"12px\");\n    scaleGroup.append(\"text\").attr(\"x\", 175).attr(\"y\", 50).attr(\"text-anchor\", \"middle\").text(\"Max Occupancy\").style(\"font-weight\", \"bold\").style(\"font-size\", \"12px\");\n    scaleGroup.append(\"text\").attr(\"x\", 175).attr(\"y\", 65).attr(\"text-anchor\", \"middle\").text(\"(people)\").style(\"font-weight\", \"bold\").style(\"font-size\", \"12px\");\n  }\n  me.color = function () {\n    return color;\n  };\n  me.extent = function () {\n    return extent;\n  };\n  return me;\n}\nexport { DensityMap };","map":{"version":3,"names":["d3","DensityMap","color","density","logScale","scaleLog","domain","range","interpolateRdYlBu","defaultColor","extent","me","selection","data","datum","residentialCommercialData","filter","d","properties","buildingType","type","geometries","map","geometry","projection","geoIdentity","reflectY","fitSize","path","geoPath","tooltip","select","append","attr","style","selectAll","join","maxOccupancy","on","event","html","pageX","pageY","max","colorScale","scaleSequential","scaleGroup","ticks","reverse","i","text"],"sources":["/Users/camillachiruzzi/vastprof/VAST2022Vue/src/assets/DensityMap.js"],"sourcesContent":["import * as d3 from 'd3';\n\nfunction DensityMap() {\n  const color = (density) => {\n    const logScale = d3.scaleLog().domain([100, 1]).range([0, 1]);\n    return density ? d3.interpolateRdYlBu(logScale(density)) : \"#f0f0f0\";\n  };\n\n  const defaultColor = \"#ffffff\"; // White color for non-residential buildings\n  let extent;\n\n  function me(selection) {\n    const data = selection.datum(); // Get the data from the selection\n\n    const residentialCommercialData = data.filter(\n      (d) => d.properties.buildingType === \"Residental\" || d.properties.buildingType === \"Commercial\"\n    );\n\n    extent = {\n      type: \"GeometryCollection\",\n      geometries: residentialCommercialData.map((d) => d.geometry),\n    };\n\n    const projection = d3.geoIdentity().reflectY(true).fitSize([650, 650], extent);\n\n    const path = d3.geoPath().projection(projection);\n\n    const tooltip = d3\n      .select(\"body\")\n      .append(\"div\")\n      .attr(\"class\", \"tooltip\")\n      .style(\"opacity\", 0);\n\n    selection\n      .selectAll(\"path\")\n      .data(data)\n      .join(\"path\")\n      .attr(\"d\", path)\n      .attr(\"fill\", (d) => {\n        if (d.properties.buildingType === \"Residental\" || d.properties.buildingType === \"Commercial\") {\n          return color(d.properties.maxOccupancy);\n        } else {\n          return defaultColor;\n        }\n      })\n      .attr(\"stroke\", \"black\")\n      .attr(\"stroke-width\", 1)\n      .on(\"mouseover\", (event, d) => {\n        const maxOccupancy = d.properties.maxOccupancy;\n        tooltip\n          .style(\"opacity\", 1)\n          .html(`Max Occupancy: ${maxOccupancy}`)\n          .style(\"left\", event.pageX + \"px\")\n          .style(\"top\", event.pageY + \"px\");\n      })\n      .on(\"mouseout\", () => {\n        tooltip.style(\"opacity\", 0);\n      });\n\n    // ADDING THE SCALEBAR\n    const maxOccupancy = d3.max(residentialCommercialData, (d) => d.properties.maxOccupancy);\n    const colorScale = d3.scaleSequential(d3.interpolateRdYlBu).domain([1, maxOccupancy]);\n\n    const scaleGroup = selection.append(\"g\").attr(\"transform\", \"translate(10, 620)\");\n    scaleGroup\n      .selectAll(\"rect\")\n      .data(colorScale.ticks(10).reverse())\n      .join(\"rect\")\n      .attr(\"x\", (d, i) => i * 37)\n      .attr(\"y\", 0)\n      .attr(\"width\", 37)\n      .attr(\"height\", 10)\n      .attr(\"fill\", (d) => colorScale(d));\n\n    scaleGroup\n      .selectAll(\"text\")\n      .data(colorScale.ticks(10))\n      .join(\"text\")\n      .attr(\"x\", (d, i) => i * 37)\n      .attr(\"y\", 25)\n      .attr(\"text-anchor\", \"middle\")\n      .text((d) => d)\n      .style(\"font-weight\", \"bold\")\n      .style(\"font-size\", \"12px\");\n\n    scaleGroup\n      .append(\"text\")\n      .attr(\"x\", 175)\n      .attr(\"y\", 50)\n      .attr(\"text-anchor\", \"middle\")\n      .text(\"Max Occupancy\")\n      .style(\"font-weight\", \"bold\")\n      .style(\"font-size\", \"12px\");\n\n    scaleGroup\n      .append(\"text\")\n      .attr(\"x\", 175)\n      .attr(\"y\", 65)\n      .attr(\"text-anchor\", \"middle\")\n      .text(\"(people)\")\n      .style(\"font-weight\", \"bold\")\n      .style(\"font-size\", \"12px\");\n  }\n\n  me.color = function () {\n    return color;\n  };\n\n  me.extent = function () {\n    return extent;\n  };\n\n  return me;\n}\n\nexport { DensityMap };\n"],"mappings":"AAAA,OAAO,KAAKA,EAAE,MAAM,IAAI;AAExB,SAASC,UAAUA,CAAA,EAAG;EACpB,MAAMC,KAAK,GAAIC,OAAO,IAAK;IACzB,MAAMC,QAAQ,GAAGJ,EAAE,CAACK,QAAQ,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7D,OAAOJ,OAAO,GAAGH,EAAE,CAACQ,iBAAiB,CAACJ,QAAQ,CAACD,OAAO,CAAC,CAAC,GAAG,SAAS;EACtE,CAAC;EAED,MAAMM,YAAY,GAAG,SAAS,CAAC,CAAC;EAChC,IAAIC,MAAM;EAEV,SAASC,EAAEA,CAACC,SAAS,EAAE;IACrB,MAAMC,IAAI,GAAGD,SAAS,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC;;IAEhC,MAAMC,yBAAyB,GAAGF,IAAI,CAACG,MAAM,CAC1CC,CAAC,IAAKA,CAAC,CAACC,UAAU,CAACC,YAAY,KAAK,YAAY,IAAIF,CAAC,CAACC,UAAU,CAACC,YAAY,KAAK,YACrF,CAAC;IAEDT,MAAM,GAAG;MACPU,IAAI,EAAE,oBAAoB;MAC1BC,UAAU,EAAEN,yBAAyB,CAACO,GAAG,CAAEL,CAAC,IAAKA,CAAC,CAACM,QAAQ;IAC7D,CAAC;IAED,MAAMC,UAAU,GAAGxB,EAAE,CAACyB,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAI,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAEjB,MAAM,CAAC;IAE9E,MAAMkB,IAAI,GAAG5B,EAAE,CAAC6B,OAAO,CAAC,CAAC,CAACL,UAAU,CAACA,UAAU,CAAC;IAEhD,MAAMM,OAAO,GAAG9B,EAAE,CACf+B,MAAM,CAAC,MAAM,CAAC,CACdC,MAAM,CAAC,KAAK,CAAC,CACbC,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,CACxBC,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;IAEtBtB,SAAS,CACNuB,SAAS,CAAC,MAAM,CAAC,CACjBtB,IAAI,CAACA,IAAI,CAAC,CACVuB,IAAI,CAAC,MAAM,CAAC,CACZH,IAAI,CAAC,GAAG,EAAEL,IAAI,CAAC,CACfK,IAAI,CAAC,MAAM,EAAGhB,CAAC,IAAK;MACnB,IAAIA,CAAC,CAACC,UAAU,CAACC,YAAY,KAAK,YAAY,IAAIF,CAAC,CAACC,UAAU,CAACC,YAAY,KAAK,YAAY,EAAE;QAC5F,OAAOjB,KAAK,CAACe,CAAC,CAACC,UAAU,CAACmB,YAAY,CAAC;MACzC,CAAC,MAAM;QACL,OAAO5B,YAAY;MACrB;IACF,CAAC,CAAC,CACDwB,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CACvBA,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,CACvBK,EAAE,CAAC,WAAW,EAAE,CAACC,KAAK,EAAEtB,CAAC,KAAK;MAC7B,MAAMoB,YAAY,GAAGpB,CAAC,CAACC,UAAU,CAACmB,YAAY;MAC9CP,OAAO,CACJI,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CACnBM,IAAI,CAAE,kBAAiBH,YAAa,EAAC,CAAC,CACtCH,KAAK,CAAC,MAAM,EAAEK,KAAK,CAACE,KAAK,GAAG,IAAI,CAAC,CACjCP,KAAK,CAAC,KAAK,EAAEK,KAAK,CAACG,KAAK,GAAG,IAAI,CAAC;IACrC,CAAC,CAAC,CACDJ,EAAE,CAAC,UAAU,EAAE,MAAM;MACpBR,OAAO,CAACI,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;IAC7B,CAAC,CAAC;;IAEJ;IACA,MAAMG,YAAY,GAAGrC,EAAE,CAAC2C,GAAG,CAAC5B,yBAAyB,EAAGE,CAAC,IAAKA,CAAC,CAACC,UAAU,CAACmB,YAAY,CAAC;IACxF,MAAMO,UAAU,GAAG5C,EAAE,CAAC6C,eAAe,CAAC7C,EAAE,CAACQ,iBAAiB,CAAC,CAACF,MAAM,CAAC,CAAC,CAAC,EAAE+B,YAAY,CAAC,CAAC;IAErF,MAAMS,UAAU,GAAGlC,SAAS,CAACoB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,WAAW,EAAE,oBAAoB,CAAC;IAChFa,UAAU,CACPX,SAAS,CAAC,MAAM,CAAC,CACjBtB,IAAI,CAAC+B,UAAU,CAACG,KAAK,CAAC,EAAE,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CACpCZ,IAAI,CAAC,MAAM,CAAC,CACZH,IAAI,CAAC,GAAG,EAAE,CAAChB,CAAC,EAAEgC,CAAC,KAAKA,CAAC,GAAG,EAAE,CAAC,CAC3BhB,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZA,IAAI,CAAC,OAAO,EAAE,EAAE,CAAC,CACjBA,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAClBA,IAAI,CAAC,MAAM,EAAGhB,CAAC,IAAK2B,UAAU,CAAC3B,CAAC,CAAC,CAAC;IAErC6B,UAAU,CACPX,SAAS,CAAC,MAAM,CAAC,CACjBtB,IAAI,CAAC+B,UAAU,CAACG,KAAK,CAAC,EAAE,CAAC,CAAC,CAC1BX,IAAI,CAAC,MAAM,CAAC,CACZH,IAAI,CAAC,GAAG,EAAE,CAAChB,CAAC,EAAEgC,CAAC,KAAKA,CAAC,GAAG,EAAE,CAAC,CAC3BhB,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC7BiB,IAAI,CAAEjC,CAAC,IAAKA,CAAC,CAAC,CACdiB,KAAK,CAAC,aAAa,EAAE,MAAM,CAAC,CAC5BA,KAAK,CAAC,WAAW,EAAE,MAAM,CAAC;IAE7BY,UAAU,CACPd,MAAM,CAAC,MAAM,CAAC,CACdC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CACdA,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC7BiB,IAAI,CAAC,eAAe,CAAC,CACrBhB,KAAK,CAAC,aAAa,EAAE,MAAM,CAAC,CAC5BA,KAAK,CAAC,WAAW,EAAE,MAAM,CAAC;IAE7BY,UAAU,CACPd,MAAM,CAAC,MAAM,CAAC,CACdC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CACdA,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC7BiB,IAAI,CAAC,UAAU,CAAC,CAChBhB,KAAK,CAAC,aAAa,EAAE,MAAM,CAAC,CAC5BA,KAAK,CAAC,WAAW,EAAE,MAAM,CAAC;EAC/B;EAEAvB,EAAE,CAACT,KAAK,GAAG,YAAY;IACrB,OAAOA,KAAK;EACd,CAAC;EAEDS,EAAE,CAACD,MAAM,GAAG,YAAY;IACtB,OAAOA,MAAM;EACf,CAAC;EAED,OAAOC,EAAE;AACX;AAEA,SAASV,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}